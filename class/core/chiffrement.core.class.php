<?php
class chiffrement {
    private static $cipher  = MCRYPT_RIJNDAEL_128;          // Algorithme utilisé pour le cryptage des blocs
    private static $key     = '2Hp6peU4ga96qsGTJEZ5Q8B1dU1JiT1kC1v92q0Pd7lA39AnuaIZqng04FS4ReIgAqthmRjzGV42Eoe9svT1jaiCmDwM05NuZ0Osr8H75T2316Ztqk5xoR50dV6hYLoZtDb9nsPd2AExG7LL8Axczod5T1751C19NX443FQhk5AoU94movkR31lyI3504g2TD03bG6mId6T476Pu47nDPTu4DXtB3g4B3by7h69ORcqYp8Q1MiK736H14Y6qIO3e5Ejly8OTs77AU11trh9229JiXdKlZap2b6gTQIb27YFdB5PKSUimgX25WRBQF0B7Cv6cTPcTW7Y2PsB9E0bFwA1J0dSzE0009u5xs84l8AM32Uk3xk2zA5jV4SS2uA5Gdqf9eJHJj841o1Ec6nCAn1lYxG0s1513ZuMWS6ma353Qo53M7ZXzweYp2SMu10LvI26yl27grM24A0ux60WWFg51v237Rn0aveLkg16G86le05219ETY6YOX6dmkb3U88C238c7xc4i48HakPp2M7hIT3scgJRhg9Y3kwS9VsPHfTgpc1BXlLU2XjitHUXjmfQl87S0fZHDkvdgfAR3e31AhNnZd703gJ967eXl4rwt31YI0E752Lal9RP7qKlfx3gTp9YKi3vInHKC5IC8VrC74SsB2Ex1uUN373P6K06Zty7T04R23mhlE7yrBy4R1902qcTRZK4zA727LZj46G9Yp01Emt92TMBbWmtp1TtUD2EPF3LmOtrrzi9916BpYw6rsKjoCW5U9QC9y9d3a02g3qwAYSs8D4h2619dfdtaWgIjqIx4Hr0zrsh85KT7EAwX8CCS1muZc9H0v3j3ExlzS0asAVv2zL15Wd6zufJ4n7Ysdkr1841l5IJ3eQDjQaPO4pqM3w8eBNs41Pvo3UO377PcHS75f6u2m5n8YN9nkiQ2XZe6J36Wnd74zldj1r5c06XLezpfc9t3nGz9K4IvAf30uLkLx7D3IT94mVYRaAf4nj455SY5Zb76676ikqNc3WvacAkXeD3tvc8Ti29ye18L727QhPy50l26BNpGGV6g0zjgI7mah8cB55ULmp6Je6L772sO77LU2989MunX4Dk12nvWzTc8D8IE35Y245oMqD1OLv2xM94Gdpz4J6Hzx3ztv1ATn7x63YFPR4tkUAX93G17t5swKDniE75l6LZkOVo7Z30Zrk4mRHi0nZj7BzIVCV5FtKEMMmNmfgXG95Gyp2uKrsE9ZP848VVsd3536GRZ92Pk29d0qnWA25L4Wl72EynQbV397F8DKb37we569jqdJ9mkS2jaT79iTGqWrKOGNPvD062O3P2BlxArdd8xJqt0q0iXcI4eO4e10X9C2mTZ6a5YBGudAGrUoTtD891G8p5GjBF3C8L7x7yWYGP61WJ5C319nVeHYYC1AODTiC46oI9842uank9vb5PVR46yph977hFOC1b0cvbc931CunHxqhYp25kok6D6Tixj7ZhT2GOdi4GCU53ZyiLX7X9yq94L9ucCSb9iL3wIKc2o1ikD9Ts2QR58oWZ35OxVZRofjynN1a9HQvw87OfP286VCpbXI6eKglisO25b81PO56Kq815r92Ghs2A8xq4Nhop29D9zNvOF33B9reU5gi8pTjG4oajXihPn8M4AZ1TxD556X9QWNCdF9QCeft4FVb13bDG3lVS1wFz27ibAFYvsp3KJbG8St69SO0Nu68luIF07k71170y8EiT8hbrEGsxvrE0iCYL0Rk2oOsrjlZp99Ww9oDU71t516hz0aJn2voAIaU0eWk42l4s6yqpe3b2RX7HnGUjR1Jf9S9xe9w5oae5W40fkZMC3q74qjZG29eBKAuiSyoq3JSXFMt0t9YLx79nns97rZF082078ggB686710bDj2M5QH7I03Wvv6rz0UeQq3vklCkEvt79ZaP1u4uFd3orf88vQpU6he6rml3jz8R9Uv59uS84SoCf770be3Gn1JVZQY92sD4q74VMBRHhS05387NVzPZmh77by445bZyDDfOD5hPYO2eKu2z57WgvNBMf44LoF9oFCD06925VHf6HP1demA6pTiL9By1gKKYG7vIz5A70QDX98r77d1QSsLT1dg144KV4rCL807UlP50Tybj7b4c54QZltxF41zoIjz4M2Af4AkmyF58fead952292168HKm521uM7g9dcsDEB49EtLwHxtOC9568TyYt11QqLW3W39E7E272kUpyh5q096NbviU71H9aA3PBo0I0wtmzWifLvU5pUL4kREN8BljX3z51I6HVXcUSnQ0196M81nY0gYT6L2OMkdDW8c3zVKHt9tVnSvIzVQP44Lq1f4B3Fo7lFo9M2nF4g3kcZ229F1fF5aUS94Ke7nM4n400UN10cfSWgyR25w54b2o9TcTax1XlgI997PbcEq6ES9Yz7foOrsoM8Ea9H67orP6JRl02KPV0DtI700P761yb9Aql666zvc18pfCX91HYvrdkIh74n6iHtj6x10r0009SWh8c4dH3iI46a1YSu6KbG63391Dr7454TCSF327001m14Y2JmIVDSrZJDx3xBTz134jqkl50pio2XXW7IrcqzU09b4i5Hcbnv74K1e4177TMBnSAR53O579MqEbnaw3GISGZw9K6XRG5BkHi6tgj9Eb7ZAazyN3CH0k3gbd3L5eK3Ab2aHdCCQP24kCgYp725I61R2499zN57X900qgpfhviHk4z6N95AD6W65Vs0hNVXKBzjRX95C00XZ3ezUF2jaT79Aba1fhe4z4toBxABo7n120S2uq8B0mQZn1C8fhdIAfNDv9KU1GR8d3338N77lp68var61t9385A14i7nUu4lRT48QRJEPVxa5utT6jQHiQ5G6N0a8F59R52h81PS8h2lBV547kg10Cv4uqfBOk9I5M4cJNQ0Xr6QKrDr8y9F2f0alfak83t1Dqm2slyq359jKZ5Dehv7G67toIb9fFW1bYE8e7kKwn2SJxZ3E3r9XpWs7mFw9fZw7dWK8Z9Pm8r92T46M6NN4C5w8WdrtWmxjl1gMpO0P13U1dd43UF8f51H771y5GiDv4r1I2S20W1WDw08XcH1C759D6daIaj8ce7Vx6tW0on2409Z6ueBiYQngFwmT93xMt0010Jx1Rf22WCVXpMN1zU8XsLWB1DQeWC6olu3z89Xo0A9k8HvCEOgd78Ovik0NwTRVqw31RlmJS4xMt3df68VmI4pVU5JilnR0DgXg54HwWr7XAK54CYA8V3WBt4JRLkusL5Bhmt6fucNUB23Ck7K09fRP7i44TpjPK79a6fSjF5ZxYEMKA0eP9s078otM1a0IlszlDgK1k5778V04iSs7T8VSrRT8leE3ojH9y95tNws8qUN8ZsJ2CDQO8L4yuDJzGl4ClbhDtct5pi5pn36m39sc29T94Ke75D99l8J1AWWQW0j06vSk3a314ih43NKsTGdg1d0oaz1c59qTNWX1suwykqU21lb3m878rQXAhMQFAs489tsyOMSfMzCEbUdl6Qm3aVK4LI9VeFBB5BIYXN670d72VYVO6fL2FHUsbXo54C7C2AT9ti5Q59SUq0aYl8t24OBfgaA5ZpAhn68H3qWzeSoxcpFtnQUzP4o3oqH4me799ZC7Hj387v437o5kiD7ShOuAVzJ0lc8ih4GiQp65sMk7i04Lm17HYe0X6b5rj0t2KZQ32i93HNIYqK77mwI199ItJXCiJpoQ9mWPnR4IRYzxgU41Qr6sx1MaYRorj8aN146uc4VwMY9edrOp0Ku381y1AuCuFzF870USl64IhTyZ97KMwj978975gLMnslkT861bT5eekw1507Yp57G18DgCa5VxSgna3P23qZMtEy7W6ud8mQ2p0GNRvY6t6FhWAGiBIoo6so4ZIpn8aLxPsPB56S35K48b76rd75Q4Zhxz3Wb84RaodG3X2I7c293CcIT0Y7xGnGGAcKjUNIaERaPms2dx5vVsULGkBs2m3533lNR7q4yTG8rTdAVIVGT3eGx2hYvQq11PiNfy7m7ZpcxO1JGB37yaJdQjU4QbnsZSx2352e2tGu9wTBWlKPy147wLc34KK5ErPaABIap8b2y52wHfJ65Jpeq993q0G1BVGCTHT1zOWT8Itp1kQMry1s3S7fWB97yO9sNAno6OYua9PU65xD58Cz889Xb2RDpYJM2bpqEDbp2ub78v41Nmb9k88nMMhMic8tor7tG6TE56K62CXXNx1O25VM51y65v4PjDaM2UQ9SV28MxXVBR3b1eR1XWT1Gd3NBNST616M9jjSvCHhHt21g87j6143wW3ZwvRb1sO59fEQ085AFRQ58VsEGp1jhn31zJtH3C9H7WbJvpRymToxDIU99rljUljm6UzP3ru6264NII78BIfsCULrvIr71XV7G8780vjI9RIY6Je458L0N7V7pM4I2o2a6FcMv5aj1cEH3swM4Y0uy8LyFzVzsj428ZzU8Yxf35nsqzBR22j445ki882ljNb9Yiclu50OGHub4R54k48B1l6cVaU9N5ivCouM3722aV1Z937CNZFZwxvqcRt4A99136z9lvHPJPP4a9WL57u5DjRnuq109DhQD41itL9idd4kQfv4zy1q9jq9x5lC3s37h4xR8k04bsWL2ZLLaP3XQ3Uy64X82AduE3bFSYvH7NU5m0AYFA629XC7REah5wU5oZ2RtDL0hY5u9NCtH1e1F2ltQVyW52MhcyJm4XWNB2Mv6k3Yupzg1dQANx4xv0m685fPWuH4BywxKo61ULuyG0W5QRNgEztO84OCr8X5rDdVs9ak83bt8T1hJrF4j9Z3dlZ5zDDA969J09Yj4W5KOmiG1j10Yz9oYFcMPSrbRJBh68a4JF779Ln4WJJrmf837r2tJso9VM7L7l9Ax9N9Jnuohbb56eVRcgOxUA5ZggOw7J9f09QzAW088Kx5Pd7Zf7s95a';    // Clé de cryptage
    private static $mode    = 'cbc';                        // Mode opératoire (traitement des blocs)
 
    public static function cryptage($data){
        $keyHash = md5(self::$key);
        $key = substr($keyHash, 0,   mcrypt_get_key_size(self::$cipher, self::$mode) );
        $iv  = substr($keyHash, 0, mcrypt_get_block_size(self::$cipher, self::$mode) );
 
        $data = mcrypt_encrypt(self::$cipher, $key, $data, self::$mode, $iv);
        return base64_encode($data);
    }
 
    public static function decrypt($data){
        $keyHash = md5(self::$key);
        $key = substr($keyHash, 0,   mcrypt_get_key_size(self::$cipher, self::$mode) );
        $iv  = substr($keyHash, 0, mcrypt_get_block_size(self::$cipher, self::$mode) );
 
        $data = base64_decode($data);
        $data = mcrypt_decrypt(self::$cipher, $key, $data, self::$mode, $iv);
        return rtrim($data);
    }
}